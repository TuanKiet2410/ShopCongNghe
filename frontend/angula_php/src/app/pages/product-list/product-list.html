<div class="container py-5">
  <div class="row">
    <!-- ===== FILTER SIDEBAR ===== -->
    <div class="col-lg-3 mb-4">
      <div class="filter-sidebar p-4 shadow-sm rounded bg-white">
        <h5 class="fw-bold mb-3">
          <i class="bi bi-funnel me-2 text-primary"></i> Bộ lọc tìm kiếm
        </h5>

        <!-- CATEGORY -->
        <div class="mb-4">
          <label class="fw-bold small text-muted">Danh mục</label>
          <select class="form-select" [(ngModel)]="selectedCategory" (change)="applyFilter()">
            <option value="">Tất cả</option>
            <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
          </select>
        </div>

        <!-- BRAND -->
        <div class="mb-4">
          <label class="fw-bold small text-muted">Thương hiệu</label>
          <div class="form-check" *ngFor="let brand of brands">
            <input
              class="form-check-input"
              type="radio"
              name="brandGroup"
              [value]="brand"
              [(ngModel)]="selectedBrand"
              (change)="applyFilter()"
            />
            <label class="form-check-label">{{ brand }}</label>
          </div>
        </div>

        <!-- PRICE -->
        <div class="mb-4">
          <label class="fw-bold small text-muted">Mức giá</label>
          <select class="form-select" [(ngModel)]="selectedPriceRange" (change)="applyFilter()">
            <option value="">Tất cả</option>
            <option value="under-10">Dưới 10 triệu</option>
            <option value="10-30">10 - 30 triệu</option>
            <option value="over-30">Trên 30 triệu</option>
          </select>
        </div>

        <button class="btn btn-outline-danger w-100" (click)="resetFilter()">
          Đặt lại bộ lọc
        </button>
      </div>
    </div>

    <!-- ===== PRODUCT LIST ===== -->
    <div class="col-lg-9">
      <!-- SEARCH + SORT -->
      <div class="d-flex gap-3 mb-4">
        <input
          class="form-control"
          placeholder="Tìm kiếm sản phẩm..."
          [(ngModel)]="searchText"
          (keyup.enter)="onSearchChange()"
        />

        <select class="form-select w-auto" [(ngModel)]="selectedSort">
          <option value="default">Mới nhất</option>
          <option value="price-asc">Giá tăng dần</option>
          <option value="price-desc">Giá giảm dần</option>
        </select>
      </div>

      <!-- EMPTY -->
      <div *ngIf="sortedProducts.length === 0" class="text-center py-5">
        <h5 class="text-muted">Không tìm thấy sản phẩm</h5>
      </div>

      <!-- PRODUCTS -->
      <div class="row g-4">
        <div class="col-12 text-center py-5" *ngIf="sortedProducts.length === 0">
          <img src="https://cdn-icons-png.flaticon.com/512/7486/7486754.png" width="100" class="mb-3 opacity-50">
          <h5 class="text-muted">Không tìm thấy sản phẩm nào!</h5>
        </div>

        <div class="col-md-4 col-sm-6" *ngFor="let p of sortedProducts">
          <div class="card product-card h-100 border-0 shadow-sm">
            <div class="card-img-wrapper position-relative overflow-hidden">
              <img [src]="p.image" class="card-img-top" [alt]="p.name">
              <div class="overlay-actions d-flex justify-content-center align-items-center gap-2">
                <button class="btn btn-light rounded-circle" (click)="addToCart(p)"><i class="bi bi-cart-plus"></i></button>
                <button class="btn btn-light rounded-circle"><i class="bi bi-eye"></i></button>
              </div>
            </div>
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <span class="badge bg-light text-dark border">{{p.brand}}</span>
                <div class="small text-warning">
                  <span class="fw-bold text-dark me-1">{{p.brand}}</span><i class="bi bi-star-fill"></i>
                </div>
              </div>
              <h6 class="card-title fw-bold text-truncate">{{p.name}}</h6>
              <div class="mt-2">
                <span class="fw-bold text-primary fs-5">{{p.price | number}}đ</span>
                <span class="text-decoration-line-through text-muted small ms-2">{{p.price | number}}đ</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- PAGINATION -->
      <div class="d-flex justify-content-center gap-2 mt-4" *ngIf="totalPages > 1">
        <button
          class="btn btn-outline-secondary"
          (click)="goToPage(currentPage - 1)"
          [disabled]="currentPage === 1"
        >
          «
        </button>

        <button
          class="btn btn-outline-primary"
          *ngFor="let page of pageNumbers"
          (click)="goToPage(page)"
          [class.active]="page === currentPage"
        >
          {{ page }}
        </button>

        <button
          class="btn btn-outline-secondary"
          (click)="goToPage(currentPage + 1)"
          [disabled]="currentPage === totalPages"
        >
          »
        </button>
      </div>
    </div>
  </div>
</div>
